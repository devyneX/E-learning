{% extends 'base.html'%}

{% block title %}Course{% endblock%}

{% block content %}
<div class="course_content">
    <section class="course_top">
        <div class="course_top_title">
            Course Title: {{ course.course_title}}
        </div>
        <div class="course_top_title">
            Category: {{ course.category }}
        </div>
        <!-- TODO: please incorporate this into the design -->
        <!-- <div class="course_top_title">
            <h4> Rating: {{ rating }}</h4>
            <h4>Rated by {{ rating_count }} students</h4>
        </div> -->

    </section>
    <div class="course_description">
        <h3>Descriptioin:</h3>
        <span>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Tempora ipsa neque rerum quis
            nulla. Necessitatibus, quo non consequatur enim magni voluptatem ad, dolorem iste autem, corporis a amet
            ipsa
            officiis.{{ course.description }}</span>
    </div>




    {% if user.account_type == 'student' and not enrolled %}
    <div class="course_button_container">
        <button class="open-button" type="button" id="enroll_button">Enroll</button>
        <script>
            document.getElementById("enroll_button").onclick = function () {
                location.href = "{{ url_for('views.enroll', course_id = course.course_id) }}"
            };
        </script>
    </div>
    {% endif %}

    {% if user.account_type == 'student' and enrolled %}
    <div class="course_button_container">
        <button class="open-button" type="button" id="feedback_button">Feedback</button>
        <script>
            document.getElementById("feedback_button").onclick = function () {
                location.href = "{{ url_for('views.feedback', course_id=course.course_id) }}";
            };
        </script>
    </div>
    {% endif %}

    {% if user.account_type == 'teacher' and creator %}
    <div class="course_button_container">
        <button class="open-button" onclick="openForm('addContent')">Add Content</button>
    </div>

    <div class="add_content_container">
        <div class="form-popup" id="addContent">
            <form action="{{ url_for('views.add_content', course_id=course.course_id) }}" method="POST">
                <h1>Add Content</h1>
                <label for="content_title"></label>
                <input type="text" class="course_title" placeholder="Content Title" name="content_title" required><br>
    
                <label for="link"></label>
                <input type="url" class="course_url" placeholder="Link" name="link" required><br>
    
                <button type="submit" class="course_submit">Add</button>
                <button type="button" class="course_close" onclick="closeForm('addContent')">Close</button>
            </form>
        </div>
    </div>

    <div class="course_button_container">
        <button class="open-button" onclick="openForm('addAssessment')">Add Assessment</button>
    </div>
    
    <div class="add_content_container">
        <div class="form-popup" id="addAssessment">
            <form action="{{ url_for('views.add_assessment', course_id=course.course_id) }}" method="POST">
                <h2>Add Assessment</h2>
                <label for="assessment_title"></label>
                <input type="text" class="course_title" id="assessment_title_input" name="assessment_title"
                    placeholder="Assessment Title" required>
                <button class="course_submit" type="submit" id="add_assessment_submit">Add</button>
                <button type="button" class="course_close" onclick="closeForm('addAssessment')">Close</button>
            </form>
        </div>
    </div>
    {% endif %}

    <div class="course_heading">
        <h1>Contents</h1>
    </div>
    {% for study_material in study_materials %}
    <!-- show the study materials  -->
    <div class="display_container">
        <div class="course_display" id="contentBox{{ loop.index }}">
            <div class="course_display_iner">
                <h3>{{ study_material.content_title }}</h3>
            </div>
        </div>
        <script>
            document.getElementById('contentBox{{ loop.index }}').onclick = function() {
                location.href = "{{ url_for('views.content', course_id=course.course_id, content_id=study_material.content_id) }}"
            }
        </script>
    </div>
    {% endfor %}

    

    <div class="course_heading">
        <h1>Assessments</h1>
    </div>
    {% for assessment in assessments %}
    <!-- show the study materials  -->
    <div class="display_container">
        <div class="course_display" id="assessmentBox{{ loop.index }}">
            <div class="course_display_iner">
                <h3>{{ assessment.assessment_title }}</h3>
            </div>
        </div>
        <script>
            document.getElementById('assessmentBox{{ loop.index }}').onclick = function () {
                location.href = "{{ url_for('views.assessment', course_id=course.course_id, assessment_id=assessment.assessment_id) }}"
            }
        </script>
    </div>
    {% endfor %}

    
</div>

{% endblock%}